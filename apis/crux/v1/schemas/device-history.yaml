type: object
x-akamai:
  file-path: schemas/device-history.yaml
additionalProperties: false
properties:
  meta:
    $ref: pageable.yaml
  objects:
    type: array
    description: |
      Device anti-malware history.
    minItems: 1
    items:
      type: object
      additionalProperties: false
      properties:
        anti_malware_info:
          type: array
          description: |
            Anti-malware name and status for a device.
          minItems: 1
          items:
            type: object
            additionalProperties: false
            properties:
              name:
                type: string
                description: |
                  The name of the anti-malware software.
                minLength: 1
              passed:
                type: boolean
                description: |
                  Whether the device passed anti-malware checks. 
        anti_malware_running:
          type: array
          description: |
            Names of anti-malware software active on the device.
          minItems: 1
          items:
            type: string
            minLength: 1
        anti_malware_status:
          type: array
          description: |
            The anti-malware profile name and status for a device.
          items:
            type: object
            additionalProperties: false
            properties:
              name:
                type: string
                description: |
                  The name of the anti-malware software.
                minLength: 1
              passed:
                type: boolean
                description: |
                  Whether the device passed anti-malware checks. 
        browsers:
          type: array
          description: |
            Browsers active on the device.
          minItems: 1
          items:
            type: object
            additionalProperties: false
            properties:
              name:
                type: string
                description: |
                  The browser name.
                minLength: 1
              version:
                type: string
                description: |
                  The browser version.
                minLength: 1
        client_version:
          type: string
          description: |
            The version of the client.
          minLength: 1
        device_name:
          type: string
          description: |
            The name of the device.
          minLength: 1
        etp_client_status:
          type: string
          description: |
            Whether ETP client is `installed` or `not-installed`.
          enum:
          - installed
          - not-installed
        firewall_status:
          type: string
          description: |
            The status of the firewall. Either `poor` or `good`.
          enum:
          - poor
          - good
        idp_username:
          type: string
          description: |
            A unique identifier for the IDP username.
          minLength: 1
        os_auto_update:
          type: boolean
          description: |
            Enables the device's operating system automatic updates feature.
          nullable: true
        os_name:
          type: string
          description: |
            The name of the operating system.
          minLength: 1
        os_update_timestamp:
          type: string
          description: |
            ISO 8601 timestamp marking when the last operating system update occurred.
          nullable: true
        os_version:
          type: string
          description: |
            The version of the Operating System.
          nullable: true
          minLength: 1
        signal_timestamp:
          type: string
          description: |
            ISO 8601 timestamp of the latest signal received from the device.
          format: date-time
        system_disk_encryption:
          type: boolean
          description: |
            Whether the device's disk is encrypted.
        user_id:
          type: string
          description: |
            The user for the device.
          minLength: 0
