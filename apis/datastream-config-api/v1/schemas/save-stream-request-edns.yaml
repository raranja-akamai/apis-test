type: object
description: |-
  Provides information that you need to specify when creating a stream configuration.
  
x-akamai:
  file-path: schemas/save-stream-request-edns.yaml
additionalProperties: false
required:
- streamName
- groupId
- contractId
- zones
- datasetFields
- deliveryConfiguration
- destination
properties:
  contractId:
    type: string
    description: |
      Identifies the contract that has access to the product.
    title: Contract
  datasetFields:
    type: array
    description: |
      Identifies data set fields that you want to receive in logs. For the `STRUCTURED` format, the order of the identifiers defines how these fields' values appear in the log lines. See [Data set parameters](ref:data-set-parameters-api) for the complete list of the fields you can choose.
    title: Dataset fields
    items:
      type: object
      additionalProperties: false
      required:
      - datasetFieldId
      properties:
        datasetFieldId:
          type: integer
          description: |
            Identifies the field.
  deliveryConfiguration:
    type: object
    description: |
      Configures log lines, log file format, names of the log files sent to a destination, and delivery frequency for these files.
    title: Delivery configuration
    additionalProperties: false
    required:
    - format
    - frequency
    properties:
      format:
        type: string
        description: |
          The format in which you want to receive log files. You can choose the `STRUCTURED` or `JSON` format for your stream. When the delimiter is present in the request, you need to choose the `STRUCTURED` format.
        enum:
        - STRUCTURED
        - JSON
      fieldDelimiter:
        type: string
        description: |
          A delimiter that separates data set fields in the log lines, either `SPACE` or `TAB`. Set this only for the `STRUCTURED` log file `format`.
        enum:
        - SPACE
        - TAB
      frequency:
        type: object
        description: |
          The frequency to collect logs from each uploader and send them to a destination.
        additionalProperties: false
        required:
        - intervalInSeconds
        - sizeInMb
        - numberOfRecords
        properties:
          intervalInSeconds:
            type: integer
            description: |
              The interval in seconds (`30` or `60`) after which the system bundles log lines into a file and sends it to a destination.
            enum:
            - 30
            - 60
          numberOfRecords:
            type: integer
            description: |
              The maximum number of records in a single log file. When there are more records than the `numberOfRecords`, DataStream chunks the log file into different parts.
            minimum: 1
            maximum: 32000
          sizeInMb:
            type: integer
            description: |
              The maximum log file size in megabytes. When the log file size is larger than `sizeInMb`, DataStream chunks it into separate files.
            maximum: 4
      uploadFilePrefix:
        type: string
        description: |
          The log filename prefix that you want to send to an object-based destination, up to 200 characters. If unspecified, it defaults to `ak`. This data supports [Dynamic time variables](ref:custom-log-field#dynamic-time-variables), but doesn't support the dot (`.`) character. See [S3 naming conventions](https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-keys.html), [Azure blob naming conventions](https://docs.microsoft.com/en-us/rest/api/storageservices/naming-and-referencing-containers--blobs--and-metadata#:%7E:text=Blob%20Names&text=A%20blob%20name%20can%20contain,up%20to%20256%20characters%20long), and [Google Cloud Storage object naming conventions](https://cloud.google.com/storage/docs/naming-objects).
      uploadFileSuffix:
        type: string
        description: |
          The log filename suffix that you want to send to an object-based destination, up to 10 characters. If unspecified, it defaults to `ds`. This doesn't support [Dynamic time variables](ref:custom-log-field#dynamic-time-variables), and the `.`, `/`, `%`, `?` characters. See [S3 naming conventions](https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-keys.html), [Azure blob naming conventions](https://docs.microsoft.com/en-us/rest/api/storageservices/naming-and-referencing-containers--blobs--and-metadata#:%7E:text=Blob%20Names&text=A%20blob%20name%20can%20contain,up%20to%20256%20characters%20long), and [Google Cloud Storage object naming conventions](https://cloud.google.com/storage/docs/naming-objects).
        maxLength: 10
  destination:
    description: |
      The destination configuration in the stream to send logs. See [Destinations](ref:destinations) for details and features available for each destination.
    title: Destination
    oneOf:
    - $ref: azure.yaml
    - $ref: s3.yaml
    - $ref: datadog.yaml
    - $ref: splunk.yaml
    - $ref: gcs.yaml
    - $ref: https.yaml
    - $ref: sumo-logic.yaml
    - $ref: ocs.yaml
    - $ref: loggly.yaml
    - $ref: s3compatible.yaml
    - $ref: new-relic.yaml
    - $ref: elasticsearch.yaml
    - $ref: traffic-peak.yaml
    - $ref: dynatrace.yaml
  groupId:
    type: integer
    description: |
      Identifies the group that has access to the product and this stream configuration.
  notificationEmails:
    type: array
    description: |
      Email addresses where you want to send notifications about the stream's activations and deactivations. By omitting this or specifying an empty array, you can activate or deactivate the stream without notifications.
    title: Notification emails
    minItems: 0
    items:
      type: string
  streamName:
    type: string
    description: |
      The stream's name.
    title: Stream name
    maxLength: 1000
  zones:
    type: array
    description: |
      Identifies the Edge DNS zones that you want to monitor in the stream.
    title: Zones
    items:
      type: object
      additionalProperties: false
      required:
      - zoneName
      properties:
        zoneName:
          type: string
          description: |
            The zone's descriptive label.
