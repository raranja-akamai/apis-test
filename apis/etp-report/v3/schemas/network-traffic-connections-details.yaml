type: object
description: |
  Network traffic connection event details and a list of matching events.
additionalProperties: false
required:
- siteId
- siteName
- policyAction
- onrampType
- httpVersion
- httpUserAgent
- machineName
- clientRequestId
- dropInfo
- ovfActionName
- id
- connectionId
- domain
- connStartTime
- connEndTime
properties:
  id:
    type: string
    description: |
      Unique ID of the network connections event.
    minLength: 1
  clientIP:
    type: string
    description: |
      The requesting client's IP address.
  clientPort:
    type: integer
    description: |
      The requesting client's Port.
    minimum: 0
  clientRequestId:
    type: string
    description: |
      ID representing the client request.
    minLength: 0
  destinationIP:
    type: string
    description: |
      The destination IP address.
  destinationPort:
    type: integer
    description: |
      Destination / origin port.
    minimum: 0
  decryptedInternalClientIP:
    type: string
    description: |
      The decrypted form of client IP.
  siteId:
    type: integer
    description: |
      A unique identifier for the site from where the connection established.
    minimum: 1
  siteName:
    type: string
    description: |
      Site name from where the connection established.
    minLength: 1
  policyAction:
    type: string
    description: |
      Policy action exercised.
    minLength: 1
  onrampType:
    type: string
    description: |
      Onramp type used. Either `dns`, `etp_client`, `etp_offnet_client`, `explicit_proxy_http`, `explicit_proxy_tls`, `http_forwarder`, `ipsec_tunnel`, `N/A`, `onramp_dns`, or `tpaas`.
    enum:
    - dns
    - etp_client
    - etp_offnet_client
    - explicit_proxy_http
    - explicit_proxy_tls
    - http_forwarder
    - ipsec_tunnel
    - N/A
    - onramp_dns
    - tpaas
    minLength: 0
  internalClientIP:
    type: string
    description: |
      IP address of the internal client machine.
  httpVersion:
    type: string
    description: |
      HTTP protocol version used.
    minLength: 1
  httpUserAgent:
    type: string
    description: |
      User agent specified over HTTP.
    minLength: 1
  machineId:
    type: string
    description: |
      Unique ID for the machine.
    minLength: 1
  machineName:
    type: string
    description: |
      Name of the machine used.
    minLength: 1
  ovfActionId:
    type: integer
    description: |
      ID of the Open Virtualization Format (OVF) action exercised.
    minimum: -1
  ovfActionName:
    type: string
    description: |
      Name of the OVF action exercised.
    minLength: 1
  stats:
    type: object
    description: |
      Statistics about the network connection.
    additionalProperties: false
    required:
    - httpRequestCount
    - inBytes
    - outBytes
    properties:
      httpRequestCount:
        type: integer
        description: |
          Total HTTP request count of that network connection.
        minimum: 0
      inBytes:
        type: integer
        description: |
          Total incoming bytes of that network connection.
        minimum: 0
      outBytes:
        type: integer
        description: |
          Total outgoing bytes of that network connection.
        minimum: 0
  dropInfo:
    type: object
    description: |
      Dropped information about the network connection.
    additionalProperties: false
    required:
    - wasDropped
    - droppedReason
    properties:
      wasDropped:
        type: boolean
        description: |
          Was the network connection dropped.
      droppedReason:
        type: string
        description: |
          Dropped reason of that network connection.
        minLength: 1
  connectionId:
    type: string
    description: |
      Unique ID of the network connections.
    minLength: 1
  domain:
    type: string
    description: |
      The requested domain address.
    minLength: 1
  connStartTime:
    type: string
    description: |
      Connection start time in ISO 8601 format.
  connEndTime:
    type: string
    description: |
      Connection end time in ISO 8601 format.
  deviceOwnerId:
    type: string
    description: |
      Unique identifier of the device owner.
  encryptedInternalClientIp:
    type: string
    description: |
      The IP address of the client machine in encrypted form.
  encryptedInternalClientName:
    type: string
    description: |
      A descriptive name of the client machine in encrypted form.
    minLength: 1
  sublocationId:
    type: string
    description: |
      A unique identifier for the sublocation from where the connection established.
    minLength: 1
  sublocationName:
    type: string
    description: |
      Sublocation name from where the connection established.
    minLength: 1
