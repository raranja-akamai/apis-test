{
  "openapi": "3.0.0",
  "info": {
    "license": {
      "name": "Apache 2.0",
      "url": "https://www.apache.org/licenses/LICENSE-2.0.html"
    },
    "title": "DeepScan event reports",
    "version": "v3"
  },
  "servers": [
    {
      "url": "https://{hostname}/etp-report/v3"
    }
  ],
  "tags": [
    {
      "description": "Generate reports of deepscan data for a configuration's offline network.\n",
      "name": "Deepscan reports"
    }
  ],
  "paths": {
    "/configs/{configId}/deep-scan-reports": {
      "get": {
        "description": "Deepscan results for a configuration's offline network for a given time period. Use the path obtained from `/threat-events`.\n",
        "operationId": "get-scan-reports",
        "parameters": [
          {
            "description": "The start time for report data, in epoch seconds.\n",
            "in": "query",
            "name": "startTimeSec",
            "required": true,
            "schema": {
              "example": 1333631700,
              "type": "integer"
            },
            "x-akamai": {
              "file-path": "parameters/start-time-sec-query.yaml"
            }
          },
          {
            "description": "The end time for report data, in epoch seconds.\n",
            "in": "query",
            "name": "endTimeSec",
            "required": true,
            "schema": {
              "example": 1333631700,
              "type": "integer"
            },
            "x-akamai": {
              "file-path": "parameters/end-time-sec-query.yaml"
            }
          },
          {
            "description": "Filters report data using the [Filters](ref:filters) JSON object. You supply this object as the value after you define the filter parameters.\n",
            "in": "query",
            "name": "filters",
            "schema": {
              "example": "{\"action\":{\"in\":[\"1\"]},\"isAlert\":{\"in\":[\"true\"]},\"site\":{\"in\":[\"-1\"]},\"list\":{\"in\":[\"1\"]},\"policy\":{\"in\":[\"164\"]},\"category\":{\"in\":[\"1\"]},\"domain\":{\"in\":[\"njit.edu.\"]},\"destinationIp\":{\"in\":[\"1.2.1.43\"]},\"country\":{\"in\":[\"US\"]}}\n",
              "type": "string"
            },
            "x-akamai": {
              "file-path": "parameters/filters-query.yaml"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/pdf": {
                "example": "Binary PDF file",
                "schema": {
                  "description": "A Deepscan report in a PDF file.\n",
                  "format": "binary",
                  "type": "string",
                  "x-akamai": {
                    "file-path": "schemas/deepscan-report-response.yaml"
                  }
                }
              }
            },
            "description": "A binary PDF file.\n"
          },
          "400": {
            "content": {
              "application/problem+json": {
                "examples": {
                  "invalid-format": {
                    "summary": "Invalid request format",
                    "value": {
                      "type": "https://problems.omni.akamaiapis.net/http/bad-request",
                      "title": "Bad Request",
                      "detail": "The system cannot understand your request.  Please check the syntax and correct any problems.",
                      "status": 400,
                      "instance": "1e4c346b-3a36-4527-9c37-86ae748b87c5"
                    }
                  },
                  "invalid-start-time": {
                    "summary": "Invalid startTime",
                    "value": {
                      "type": "https://problems.omni.akamaiapis.net/http/bad-request",
                      "title": "Bad Request",
                      "detail": "Start time is invalid. Code-000104",
                      "status": 400,
                      "instance": "0415df5e-6e9c-4596-bdd3-9ada53b63599"
                    }
                  }
                },
                "schema": {
                  "additionalProperties": true,
                  "description": "A common [RFC 9457](https://www.rfc-editor.org/rfc/rfc9457) Problem Response error.\n",
                  "properties": {
                    "detail": {
                      "description": "A human-readable explanation specific to the problem.\n",
                      "minLength": 1,
                      "type": "string"
                    },
                    "errors": {
                      "description": "A list of HTTP problem details. The error response includes this list if there are several problems with a single request, to call out each of them separately.\n",
                      "items": {
                        "description": "A nested problem response error object.\n",
                        "type": "object",
                        "x-akamai": {
                          "file-path": "schemas/http-problem-nested.yaml"
                        }
                      },
                      "minItems": 0,
                      "type": "array"
                    },
                    "instance": {
                      "description": "The URI for this error occurrence.\n",
                      "type": "string"
                    },
                    "status": {
                      "description": "The HTTP status code generated by the origin server.\n",
                      "minimum": 0,
                      "type": "integer"
                    },
                    "title": {
                      "description": "A short, human-readable summary of the problem type.\n",
                      "minLength": 1,
                      "type": "string"
                    },
                    "type": {
                      "description": "A URI reference that identifies the problem type.\n",
                      "minLength": 1,
                      "type": "string"
                    }
                  },
                  "required": [
                    "type",
                    "title",
                    "detail",
                    "instance",
                    "status"
                  ],
                  "type": "object",
                  "x-akamai": {
                    "file-path": "schemas/http-problem.yaml"
                  }
                }
              }
            },
            "description": "[Bad Request](ref:400).\n",
            "x-akamai": {
              "file-path": "errors/400.yaml"
            }
          },
          "403": {
            "content": {
              "application/problem+json": {
                "example": {
                  "type": "https://problems.omni.akamaiapis.net/http/forbidden",
                  "title": "Forbidden",
                  "detail": "Insufficient permissions. Code-01",
                  "status": 403,
                  "instance": "3e3f11da-e205-409a-be77-24e459f29fa8"
                },
                "schema": {
                  "additionalProperties": true,
                  "description": "A common [RFC 9457](https://www.rfc-editor.org/rfc/rfc9457) Problem Response error.\n",
                  "properties": {
                    "detail": {
                      "description": "A human-readable explanation specific to the problem.\n",
                      "minLength": 1,
                      "type": "string"
                    },
                    "errors": {
                      "description": "A list of HTTP problem details. The error response includes this list if there are several problems with a single request, to call out each of them separately.\n",
                      "items": {
                        "description": "A nested problem response error object.\n",
                        "type": "object",
                        "x-akamai": {
                          "file-path": "schemas/http-problem-nested.yaml"
                        }
                      },
                      "minItems": 0,
                      "type": "array"
                    },
                    "instance": {
                      "description": "The URI for this error occurrence.\n",
                      "type": "string"
                    },
                    "status": {
                      "description": "The HTTP status code generated by the origin server.\n",
                      "minimum": 0,
                      "type": "integer"
                    },
                    "title": {
                      "description": "A short, human-readable summary of the problem type.\n",
                      "minLength": 1,
                      "type": "string"
                    },
                    "type": {
                      "description": "A URI reference that identifies the problem type.\n",
                      "minLength": 1,
                      "type": "string"
                    }
                  },
                  "required": [
                    "type",
                    "title",
                    "detail",
                    "instance",
                    "status"
                  ],
                  "type": "object",
                  "x-akamai": {
                    "file-path": "schemas/http-problem.yaml"
                  }
                }
              }
            },
            "description": "[Access forbidden](ref:403).\n",
            "x-akamai": {
              "file-path": "errors/insufficient-permissions-403.yaml"
            }
          },
          "404": {
            "content": {
              "application/problem+json": {
                "example": {
                  "type": "https://problems.omni.akamaiapis.net/http/not-found",
                  "title": "Not Found",
                  "detail": "Invalid SIA configuration 101. Code-090209",
                  "status": 404,
                  "instance": "aeb030ed-0645-484d-93e2-77e88566312c"
                },
                "schema": {
                  "additionalProperties": true,
                  "description": "A common [RFC 9457](https://www.rfc-editor.org/rfc/rfc9457) Problem Response error.\n",
                  "properties": {
                    "detail": {
                      "description": "A human-readable explanation specific to the problem.\n",
                      "minLength": 1,
                      "type": "string"
                    },
                    "errors": {
                      "description": "A list of HTTP problem details. The error response includes this list if there are several problems with a single request, to call out each of them separately.\n",
                      "items": {
                        "description": "A nested problem response error object.\n",
                        "type": "object",
                        "x-akamai": {
                          "file-path": "schemas/http-problem-nested.yaml"
                        }
                      },
                      "minItems": 0,
                      "type": "array"
                    },
                    "instance": {
                      "description": "The URI for this error occurrence.\n",
                      "type": "string"
                    },
                    "status": {
                      "description": "The HTTP status code generated by the origin server.\n",
                      "minimum": 0,
                      "type": "integer"
                    },
                    "title": {
                      "description": "A short, human-readable summary of the problem type.\n",
                      "minLength": 1,
                      "type": "string"
                    },
                    "type": {
                      "description": "A URI reference that identifies the problem type.\n",
                      "minLength": 1,
                      "type": "string"
                    }
                  },
                  "required": [
                    "type",
                    "title",
                    "detail",
                    "instance",
                    "status"
                  ],
                  "type": "object",
                  "x-akamai": {
                    "file-path": "schemas/http-problem.yaml"
                  }
                }
              }
            },
            "description": "[Configuration not Found](ref:404).\n",
            "x-akamai": {
              "file-path": "errors/not-found-404.yaml"
            }
          }
        },
        "summary": "Get deepscan details report",
        "tags": [
          "Deepscan reports"
        ]
      },
      "parameters": [
        {
          "description": "A unique identifier for each configuration.\n",
          "in": "path",
          "name": "configId",
          "required": true,
          "schema": {
            "example": 100,
            "type": "integer"
          },
          "x-akamai": {
            "file-path": "parameters/config-id-path.yaml"
          }
        }
      ],
      "x-akamai": {
        "file-path": "paths/deep-scan-reports.yaml",
        "path-info": "/configs/{configId}/deep-scan-reports"
      }
    }
  },
  "components": {
    "parameters": {
      "config-id-path": {
        "description": "A unique identifier for each configuration.\n",
        "in": "path",
        "name": "configId",
        "required": true,
        "schema": {
          "example": 100,
          "type": "integer"
        },
        "x-akamai": {
          "file-path": "parameters/config-id-path.yaml"
        }
      },
      "start-time-sec-query": {
        "description": "The start time for report data, in epoch seconds.\n",
        "in": "query",
        "name": "startTimeSec",
        "required": true,
        "schema": {
          "example": 1333631700,
          "type": "integer"
        },
        "x-akamai": {
          "file-path": "parameters/start-time-sec-query.yaml"
        }
      },
      "end-time-sec-query": {
        "description": "The end time for report data, in epoch seconds.\n",
        "in": "query",
        "name": "endTimeSec",
        "required": true,
        "schema": {
          "example": 1333631700,
          "type": "integer"
        },
        "x-akamai": {
          "file-path": "parameters/end-time-sec-query.yaml"
        }
      },
      "filters-query": {
        "description": "Filters report data using the [Filters](ref:filters) JSON object. You supply this object as the value after you define the filter parameters.\n",
        "in": "query",
        "name": "filters",
        "schema": {
          "example": "{\"action\":{\"in\":[\"1\"]},\"isAlert\":{\"in\":[\"true\"]},\"site\":{\"in\":[\"-1\"]},\"list\":{\"in\":[\"1\"]},\"policy\":{\"in\":[\"164\"]},\"category\":{\"in\":[\"1\"]},\"domain\":{\"in\":[\"njit.edu.\"]},\"destinationIp\":{\"in\":[\"1.2.1.43\"]},\"country\":{\"in\":[\"US\"]}}\n",
          "type": "string"
        },
        "x-akamai": {
          "file-path": "parameters/filters-query.yaml"
        }
      }
    },
    "schemas": {
      "deepscan-report-response": {
        "description": "A Deepscan report in a PDF file.\n",
        "format": "binary",
        "type": "string",
        "x-akamai": {
          "file-path": "schemas/deepscan-report-response.yaml"
        }
      },
      "http-problem-nested": {
        "description": "A nested problem response error object.\n",
        "type": "object",
        "x-akamai": {
          "file-path": "schemas/http-problem-nested.yaml"
        }
      },
      "http-problem": {
        "additionalProperties": true,
        "description": "A common [RFC 9457](https://www.rfc-editor.org/rfc/rfc9457) Problem Response error.\n",
        "properties": {
          "detail": {
            "description": "A human-readable explanation specific to the problem.\n",
            "minLength": 1,
            "type": "string"
          },
          "errors": {
            "description": "A list of HTTP problem details. The error response includes this list if there are several problems with a single request, to call out each of them separately.\n",
            "items": {
              "description": "A nested problem response error object.\n",
              "type": "object",
              "x-akamai": {
                "file-path": "schemas/http-problem-nested.yaml"
              }
            },
            "minItems": 0,
            "type": "array"
          },
          "instance": {
            "description": "The URI for this error occurrence.\n",
            "type": "string"
          },
          "status": {
            "description": "The HTTP status code generated by the origin server.\n",
            "minimum": 0,
            "type": "integer"
          },
          "title": {
            "description": "A short, human-readable summary of the problem type.\n",
            "minLength": 1,
            "type": "string"
          },
          "type": {
            "description": "A URI reference that identifies the problem type.\n",
            "minLength": 1,
            "type": "string"
          }
        },
        "required": [
          "type",
          "title",
          "detail",
          "instance",
          "status"
        ],
        "type": "object",
        "x-akamai": {
          "file-path": "schemas/http-problem.yaml"
        }
      }
    },
    "responses": {
      "400": {
        "content": {
          "application/problem+json": {
            "examples": {
              "invalid-format": {
                "summary": "Invalid request format",
                "value": {
                  "type": "https://problems.omni.akamaiapis.net/http/bad-request",
                  "title": "Bad Request",
                  "detail": "The system cannot understand your request.  Please check the syntax and correct any problems.",
                  "status": 400,
                  "instance": "1e4c346b-3a36-4527-9c37-86ae748b87c5"
                }
              },
              "invalid-start-time": {
                "summary": "Invalid startTime",
                "value": {
                  "type": "https://problems.omni.akamaiapis.net/http/bad-request",
                  "title": "Bad Request",
                  "detail": "Start time is invalid. Code-000104",
                  "status": 400,
                  "instance": "0415df5e-6e9c-4596-bdd3-9ada53b63599"
                }
              }
            },
            "schema": {
              "additionalProperties": true,
              "description": "A common [RFC 9457](https://www.rfc-editor.org/rfc/rfc9457) Problem Response error.\n",
              "properties": {
                "detail": {
                  "description": "A human-readable explanation specific to the problem.\n",
                  "minLength": 1,
                  "type": "string"
                },
                "errors": {
                  "description": "A list of HTTP problem details. The error response includes this list if there are several problems with a single request, to call out each of them separately.\n",
                  "items": {
                    "description": "A nested problem response error object.\n",
                    "type": "object",
                    "x-akamai": {
                      "file-path": "schemas/http-problem-nested.yaml"
                    }
                  },
                  "minItems": 0,
                  "type": "array"
                },
                "instance": {
                  "description": "The URI for this error occurrence.\n",
                  "type": "string"
                },
                "status": {
                  "description": "The HTTP status code generated by the origin server.\n",
                  "minimum": 0,
                  "type": "integer"
                },
                "title": {
                  "description": "A short, human-readable summary of the problem type.\n",
                  "minLength": 1,
                  "type": "string"
                },
                "type": {
                  "description": "A URI reference that identifies the problem type.\n",
                  "minLength": 1,
                  "type": "string"
                }
              },
              "required": [
                "type",
                "title",
                "detail",
                "instance",
                "status"
              ],
              "type": "object",
              "x-akamai": {
                "file-path": "schemas/http-problem.yaml"
              }
            }
          }
        },
        "description": "[Bad Request](ref:400).\n",
        "x-akamai": {
          "file-path": "errors/400.yaml"
        }
      },
      "insufficient-permissions-403": {
        "content": {
          "application/problem+json": {
            "example": {
              "type": "https://problems.omni.akamaiapis.net/http/forbidden",
              "title": "Forbidden",
              "detail": "Insufficient permissions. Code-01",
              "status": 403,
              "instance": "3e3f11da-e205-409a-be77-24e459f29fa8"
            },
            "schema": {
              "additionalProperties": true,
              "description": "A common [RFC 9457](https://www.rfc-editor.org/rfc/rfc9457) Problem Response error.\n",
              "properties": {
                "detail": {
                  "description": "A human-readable explanation specific to the problem.\n",
                  "minLength": 1,
                  "type": "string"
                },
                "errors": {
                  "description": "A list of HTTP problem details. The error response includes this list if there are several problems with a single request, to call out each of them separately.\n",
                  "items": {
                    "description": "A nested problem response error object.\n",
                    "type": "object",
                    "x-akamai": {
                      "file-path": "schemas/http-problem-nested.yaml"
                    }
                  },
                  "minItems": 0,
                  "type": "array"
                },
                "instance": {
                  "description": "The URI for this error occurrence.\n",
                  "type": "string"
                },
                "status": {
                  "description": "The HTTP status code generated by the origin server.\n",
                  "minimum": 0,
                  "type": "integer"
                },
                "title": {
                  "description": "A short, human-readable summary of the problem type.\n",
                  "minLength": 1,
                  "type": "string"
                },
                "type": {
                  "description": "A URI reference that identifies the problem type.\n",
                  "minLength": 1,
                  "type": "string"
                }
              },
              "required": [
                "type",
                "title",
                "detail",
                "instance",
                "status"
              ],
              "type": "object",
              "x-akamai": {
                "file-path": "schemas/http-problem.yaml"
              }
            }
          }
        },
        "description": "[Access forbidden](ref:403).\n",
        "x-akamai": {
          "file-path": "errors/insufficient-permissions-403.yaml"
        }
      },
      "not-found-404": {
        "content": {
          "application/problem+json": {
            "example": {
              "type": "https://problems.omni.akamaiapis.net/http/not-found",
              "title": "Not Found",
              "detail": "Invalid SIA configuration 101. Code-090209",
              "status": 404,
              "instance": "aeb030ed-0645-484d-93e2-77e88566312c"
            },
            "schema": {
              "additionalProperties": true,
              "description": "A common [RFC 9457](https://www.rfc-editor.org/rfc/rfc9457) Problem Response error.\n",
              "properties": {
                "detail": {
                  "description": "A human-readable explanation specific to the problem.\n",
                  "minLength": 1,
                  "type": "string"
                },
                "errors": {
                  "description": "A list of HTTP problem details. The error response includes this list if there are several problems with a single request, to call out each of them separately.\n",
                  "items": {
                    "description": "A nested problem response error object.\n",
                    "type": "object",
                    "x-akamai": {
                      "file-path": "schemas/http-problem-nested.yaml"
                    }
                  },
                  "minItems": 0,
                  "type": "array"
                },
                "instance": {
                  "description": "The URI for this error occurrence.\n",
                  "type": "string"
                },
                "status": {
                  "description": "The HTTP status code generated by the origin server.\n",
                  "minimum": 0,
                  "type": "integer"
                },
                "title": {
                  "description": "A short, human-readable summary of the problem type.\n",
                  "minLength": 1,
                  "type": "string"
                },
                "type": {
                  "description": "A URI reference that identifies the problem type.\n",
                  "minLength": 1,
                  "type": "string"
                }
              },
              "required": [
                "type",
                "title",
                "detail",
                "instance",
                "status"
              ],
              "type": "object",
              "x-akamai": {
                "file-path": "schemas/http-problem.yaml"
              }
            }
          }
        },
        "description": "[Configuration not Found](ref:404).\n",
        "x-akamai": {
          "file-path": "errors/not-found-404.yaml"
        }
      }
    }
  },
  "x-akamai": {
    "auth-type": "EDGE_GRID",
    "file-path": "09-deepscan-report.yaml"
  }
}